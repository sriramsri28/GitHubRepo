/*!
 * 
 *     MCAFEE RESTRICTED CONFIDENTIAL
 *     Copyright (c) 2023 McAfee, LLC
 *
 *     The source code contained or described herein and all documents related
 *     to the source code ("Material") are owned by McAfee or its
 *     suppliers or licensors. Title to the Material remains with McAfee
 *     or its suppliers and licensors. The Material contains trade
 *     secrets and proprietary and confidential information of McAfee or its
 *     suppliers and licensors. The Material is protected by worldwide copyright
 *     and trade secret laws and treaty provisions. No part of the Material may
 *     be used, copied, reproduced, modified, published, uploaded, posted,
 *     transmitted, distributed, or disclosed in any way without McAfee's prior
 *     express written permission.
 *
 *     No license under any patent, copyright, trade secret or other intellectual
 *     property right is granted to or conferred upon you by disclosure or
 *     delivery of the Materials, either expressly, by implication, inducement,
 *     estoppel or otherwise. Any license under such intellectual property rights
 *     must be expressed and approved by McAfee in writing.
 *
 */(()=>{"use strict";const e="LOCAL_STORE",t="CONTENT_HANDLER",s="EXECUTE_COMMAND",n="FOCUS_OR_CREATE_TAB",a="GET_BK_GLOBALS",r="GET_EXTENSION_STATUS",o="GET_TAB_DATA",i="TI_REQUEST",c="PLACEHOLDER_TEXT",m="REMOVE_TAB",l="SEND_TELEMETRY",d="SET_VIEWPORT",u="WHITELIST",g="RESET_NATIVE_SETTING",E="UPDATE_BK_NATIVE_SETTINGS",T="SHOW_SIDEBAR_MAIN",_="GET_POPUP_DATA",h="GET_SETTINGS_DATA",S="RESET_SETTINGS",N="GET_TYPOSQUATTING_DATA",A="IS_FRAME_BLOCKED",O="IS_WHITELISTED",I="ANY_BLOCKED_IFRAMES",P="ANY_BLOCKED_CRYPTOSCRIPTS",R="UNBLOCK_ALL_IFRAMES",M="VIEW_SITE_REPORT",b="SEARCH_ANNOTATION",F="UPDATE_ENGINE_STATS",C="SOCIAL_MEDIA_ANNOTATION",p="UPDATE_RAT_DETECTION_SHOWING_FLAG",f="SEARCH_SUGGEST",D="SAVE_FORM_INFO",L="GET_FORM_INFO_CACHE",U="CLEAR_FORM_INFO_CACHE",w="SAVE_MULTISTEP_LOGIN",y="GET_FD_WEIGHTS",W="GET_FD_EXCEPTIONS",G="GET_FD_CRF_PARAMS",k="CLEAR_DWS_INFO",B="GET_CACHED_DWS_INFO",v="UPDATE_DWS_WHITELIST",H="LAUNCH_IDPS_LOGIN",x="UPDATE_DWS_SHOWN",$="GET_APS_DETAILS",K="SIGN_UP_FORM_DETECTED",Y="SET_FF_POLICY_COLLECTION",q="SET_FF_POLICY_LAST_SHOWN",V="PING_CONTENT_APS_OBSERVER",z="BROADCAST_TO_FOREGROUND";class j{constructor(e){this.pingCommand=e,this.basePingListener()}basePingListener(e=null){chrome.runtime.onMessage.addListener(((t,s,n)=>{if(s.id!==chrome.runtime.id)return;const{command:a}=t;a===this.pingCommand&&(n({content:!0}),"function"==typeof e&&e())}))}}const Q={GREEN:0,YELLOW:1,RED:2,UNKNOWN:3,HACKERSAFE:4,TYPOSQUATTING:5,PHISHING:6,*[Symbol.iterator](){for(const e of Object.keys(this))"GREEN"!==e&&"UNKNOWN"!==e&&(yield this[e])}},X=1,J=2,Z=3,ee=2,te=0,se=1,ne=2,ae=3,re=5,oe=70,ie=31,ce=16,me=1,le="ph",de="www.siteadvisor.com/",ue=(new Set(["www.mcafee.com"]),chrome),ge=0,Ee=0,Te=1,_e=2,he=3,Se=4,Ne=1,Ae=2,Oe=3,Ie=4,Pe={BACKGROUND:"BACKGROUND",CONTENT:"CONTENT",TELEMETRY:"TELEMETRY"},Re={DEFAULT:"color: #000000; font-weight: normal; font-style:normal; background: #FFFFFF;",BACKGROUND:"color: #8D0DBA; font-weight: bold; background: #FFFFFF;",CONTENT:"color: #F54A26; font-weight: bold; background: #FFFFFF;",TELEMETRY:"color: #147831; font-weight: bold; background: #FFFFFF;"};class Me{static log(e,t=null){be(e,Ne,t)}static error(e,t=null){be(e,Ae,t)}static warn(e,t=null){be(e,Oe,t)}static debug(e,t=null){be(e,Ie,t)}}const be=(e,t,s)=>{const n=ge;if(n===Ee)return;let a="chrome-extension:"===location.protocol?Pe.BACKGROUND:Pe.CONTENT;s&&Pe[s]&&(a=s);const r=new Date,o=t===Ae?e:`%c[${a} ${r.toLocaleString([],{hour:"2-digit",minute:"2-digit",hour12:!0})}]: %c${e}`,i=Re.DEFAULT;let c=Re[a];if(c||(c=i),n>=_e&&t===Ae&&console.error(e),n>=Te&&t===Ne&&console.log(o,c,i),n>=he&&t===Oe){const e="color: #FFA500; font-family: sans-serif; font-weight: bolder; text-shadow: #000 1px 1px;";console.log(`%cWARN - ${o}`,e,c,i)}if(n>=Se&&t===Ie){const e="color: #FF33D7; font-family: sans-serif; font-weight: bolder; text-shadow: #000 1px 1px;";console.log(`%cDEBUG - ${o}`,e,c,i)}},Fe={ANNOTATION:{},BackgroundIPC:null,BackgroundCommons:null,ContextTelemetry:null,TelemetryEventNames:null,UrlParser:null,Utils:null,Commands:{},CommonConstants:{},extension:null,SearchEngineHelper:null,prevLink:null,Logger:null};class Ce{static getResString(e,t){Fe.ANNOTATION.resourceRequestor.getResStr(e,(s=>{s?t(s):Fe.Logger.error(`Resource string ${e} failed to fetch through resource requestor`)}))}}class pe{static async toGTICategoriesString(e,t=!1){const s=e=>new Promise((t=>{Ce.getResString(e,(e=>t(e)))})),n=async(e,t)=>{const n={},a=await s(`category_id_${e}_name`);if(n.name=a,t){const t=await s(`category_id_${e}_description`);n.description=t}return n},a=[];for(const s of e)a.push(n(s,t));return await Promise.all(a)}static browserTypeToString(e=!1){let t="";switch(ee){case 1:t="FF";break;case 2:t="CH";break;case 3:t="ED";break;default:t="UN"}return e?t.toLowerCase():t}static toImagePaths(e){let t="images/browser_action/";switch(e.startsWith("small_")?e:`small_${e}`){case"small_button_green.gif":t+="green";break;case"small_button_yellow.gif":t+="yellow";break;case"small_button_red.gif":t+="red";break;case"small_button_grey.gif":t+="white";break;case"small_button_disabled.gif":t+="disabled";break;default:t+=e}return{size16:`${t}_16.png`,size20:`${t}_20.png`,size32:`${t}_32.png`,size40:`${t}_40.png`}}static colorToImagePaths(e){let t="white";switch(e){case te:t="green";break;case se:t="yellow";break;case ne:t="red";break;case ae:t="white";break;case re:t="disabled"}return pe.toImagePaths(t)}static toAnnotationImageClass(e){let t="";switch(pe.toColor(e)){case te:t="OK";break;case ne:t="WARN";break;case se:t="INFO";break;case ae:t="UNKNOWN"}return t}static isPhishingURI(e){return e&&e.includes(le)}static toBlockState(e){const t=pe.toColor(e);return t!==ne&&t!==se||!pe.isPhishingURI(e.category)?isNaN(t)?Q.UNKNOWN:t:Q.PHISHING}static toColor(e){let t=ae;return void 0===e||void 0===e.trust||(t=e.trust>=oe?te:e.trust>=ie?ae:e.trust>=ce?se:e.trust>=me?ne:ae),t}static toSiteReportUrl(e){return`${ue.runtime.getURL("html/site_status_site_report.html")}?url=${escape(e)}`}static isExtensionUrl(e){if(J===ee&&e.startsWith(`chrome-extension://${ue.runtime.id}`)||Z===ee&&e.startsWith(`ms-browser-extension://${ue.runtime.id}`))return!0;if(X===ee){let t=ue.i18n.getMessage("@@extension_id");if(!t){const e=ue.runtime.getURL("images/web_advisor/logo.png").split("/");t=e.length>=3?e[2]:""}return t&&e.startsWith(`moz-extension://${t}`)}return!1}static isSafeUrl(e){return pe.isSiteAdvisorUrl(e)||pe.isExtensionUrl(e)}static isSiteAdvisorUrl(e){return e.startsWith(`http://${de}`)||e.startsWith(`https://${de}`)}static isPropertRedirectUrl(e){return pe.isPropertyWebURL(e)||e.startsWith("edge://")||e.startsWith("chrome://")}static isProperWebURL(e){return!!(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("ftp://"))}static getUINumber(e){if(e>=1e4)return"10k+";if(e>=1e3){let t=(e/1e3).toFixed(1);return t="0"===t.substring(2,3)?t.substring(0,1):t,`${t}k+`}return`${e}`}static hasEpochTimeElapsed(e,t){return(new Date).getTime()/1e3>e+t}static isPersonalPolicyEnabled(){return!0}static isActivityPolicyEnabled(){return!0}static blockRequest(e,t,s){ue.declarativeNetRequest.getDynamicRules((n=>{0===n.filter((e=>e.condition.urlFilter===t)).length&&ue.declarativeNetRequest.updateDynamicRules({addRules:[{id:n.length+1,condition:{domains:["<all_urls>"],urlFilter:t,resourceTypes:["main_frame"]},action:{type:"block"}}]},(()=>{Me.log(`${s} ${t} ${e}`)}))}))}}class fe{static getURI(e){let t=e.split("?");return t.length>1?t[0]:(t=e.split("#"),t.length>1?t[0]:e)}static getCleanURI(e){let t=e;return t.endsWith("/")&&(t=t.slice(0,-1)),t.startsWith("http://")?t=t.slice(7):t.startsWith("https://")&&(t=t.slice(8)),this.getURI(t)}static getParam(e,t){const s=e.indexOf("?");if(-1===s)return null;const n=e.substring(s+1).split("&");for(let e=0;e<n.length;++e){const s=n[e].indexOf("=");if(-1===s)continue;if(n[e].substring(0,s)===t){return n[e].substring(s+1)}}return null}static getDomain(e){if(void 0===e||!/^https?:\/\//.test(e))return"";return new URL(e).hostname}static decodeQueryParam(e){return decodeURIComponent(e.replace(/\+/g," "))}}const De={NONE:0,LINKEDIN:1,INSTAGRAM:2,YOUTUBE:4,FACEBOOK:8,TWITTER:16,REDDIT:32},Le=(Object.values(De).reduce(((e,t)=>e+t)),{NONE:"NONE",ONLY_SECURE_SEARCH:"ONLY_SECURE_SEARCH",ALL:"ALL",*[Symbol.iterator](){for(const e of Object.keys(this))yield e}}),{NONE:Ue,...we}=De,ye="SET",We="GET",Ge={name:"APS_EMAIL_LINKS",type:"array"};class ke{static handlePromiseMessage(e,t=null){return new Promise(((s,n)=>{chrome.runtime.sendMessage(e,(e=>{"function"==typeof t?t(s,n,e):((e,t,s)=>{chrome.runtime.lastError&&t(chrome.runtime.lastError.message),e(s)})(s,n,e)}))}))}}class Be{static localStore(t,s){const n=e;return ke.handlePromiseMessage({command:n,action:t,data:s})}static sessionStore(t,s){const n=e;return ke.handlePromiseMessage({command:n,action:t,data:s})}static isFrameBlocked(e){const t=A;return ke.handlePromiseMessage({command:t,url:e})}static makeMTIRequest(e,t){const s={command:i,requestData:e,referer:t};return ke.handlePromiseMessage(s)}static executeCommand(e,t){const n=s;ue.runtime.sendMessage({command:n,commandId:e,params:t})}static focusOrCreateTab(e){const t=n;ue.runtime.sendMessage({command:t,url:e})}static closeTab(){const e=m;ue.runtime.sendMessage({command:e})}static whitelist(e,t,s){const n=u;return ke.handlePromiseMessage({action:e,command:n,type:t,data:s})}static getPopupData(){const e=_;return ke.handlePromiseMessage({command:e})}static getSettingsData(){const e=h;return ke.handlePromiseMessage({command:e})}static searchAnnotation(e,t){const s=b;return ke.handlePromiseMessage({action:e,data:t,command:s})}static socialMediaAnnotation(e,t){const s=C;return ke.handlePromiseMessage({action:e,data:t,command:s})}static async getBkGlobals(e=!1){return new Promise((t=>{const s=a;ke.handlePromiseMessage({command:s,bIncludeSearchEngines:e}).then((e=>{t(JSON.parse(e))}))}))}static viewSiteReport(e=null,t=!1){const s=M;ue.runtime.sendMessage({command:s,url:e,showInNewTab:t})}static getTypoSquattingData(e){const t=N;return ke.handlePromiseMessage({command:t,domain:e})}static getPlaceholderText(e){const t=c;return ke.handlePromiseMessage({command:t,id:e})}static setViewPort(e,t){const s=d;ue.runtime.sendMessage({command:s,x:e,y:t})}static sendTelemetry(e){const t=l;ue.runtime.sendMessage({command:t,telemetry:e})}static anyBlockedIframes(e){const t=I;return ke.handlePromiseMessage({command:t,frameUrls:e})}static anyBlockedCryptoScripts(){const e=P;return ke.handlePromiseMessage({command:e})}static resetSettings(){const e=S;ue.runtime.sendMessage({command:e})}static sendEngineStat(e){ue.runtime.sendMessage({command:F,engine:e})}static contentHandler(e){const s=t;ue.runtime.sendMessage({command:s,message:e})}static getTabData(e={}){const t={command:o,...e};return ke.handlePromiseMessage(t)}static isWhitelisted(e){const t={command:O,url:e};return ke.handlePromiseMessage(t)}static getExtensionStatus(e){return ke.handlePromiseMessage({command:r,extension_id:e})}static unblockAllIframes(){const e=R;ue.runtime.sendMessage({command:e})}static updateRatDetectionShowingFlag(e){const t=p;ue.runtime.sendMessage({command:t,showed:e})}static getSearchSuggest(e){const t={command:f,searchTerm:e};return ke.handlePromiseMessage(t)}static resetNativeSetting(e){const t=g;ue.runtime.sendMessage({command:t,setting:e})}static saveFormInfo(e,t){const s=D;ue.runtime.sendMessage({command:s,username:e,hostname:t})}static saveMultiStepLogin(e,t){const s=w;ue.runtime.sendMessage({command:s,data:e,completeLogin:t})}static getFormInfoCache(){const e=L;return ke.handlePromiseMessage({command:e})}static clearFormInfoCache(){const e=U;ue.runtime.sendMessage({command:e})}static updateDWSWhitelist(e){const t=v;ue.runtime.sendMessage({command:t,email:e})}static getCachedDWSInfo(e){const t={command:B,email:e};return ke.handlePromiseMessage(t)}static clearCachedDWSInfo(e){const t=k;ue.runtime.sendMessage({command:t,email:e})}static updateDWSShown(e){const t=x;ue.runtime.sendMessage({command:t,email:e})}static getAPSDetails(){const e=$;return ke.handlePromiseMessage({command:e})}static signUpFormDetected(){const e=K;ue.runtime.sendMessage({command:e})}static updateBkNativeSettings(e,t){const s=E;ue.runtime.sendMessage({command:s,name:e,value:t})}static launchIDPSLogin(){const e=H;ue.runtime.sendMessage({command:e})}static showSidebarMain(){const e=T;ue.runtime.sendMessage({command:e})}static setFFPolicyCollection({personal:e,activity:t}){const s=Y;ue.runtime.sendMessage({command:s,personal:e,activity:t})}static setFFPolicyLastShown(){const e=q;ue.runtime.sendMessage({command:e})}static broadcastToForeground(e){const t=z;ue.runtime.sendMessage({command:t,payload:e})}static getFDWeights(){const e=y;return ke.handlePromiseMessage({command:e})}static getFDExceptions(){const e=W;return ke.handlePromiseMessage({command:e})}static getFDCrfParams(){const e=G;return ke.handlePromiseMessage({command:e})}}(new class extends j{constructor(){super(V)}async main(){const e=document.location.href,t=Ge.name,s=(await Be.sessionStore(We,{[t]:[]}))[t],{apsUrlList:n}=await Be.getBkGlobals(),a=n.email,r=Object.keys(a).find((t=>e.includes(t)));if(r){const e=a[r].selector;this.initEmailObserver(e,s)}else this.initEmailObserver()}initEmailObserver(e,t){const s=()=>{const s=document.querySelectorAll(e);s.length&&s.forEach((e=>{const s=e.getAttribute("href");"true"!==e.getAttribute("mcafee_aps")&&s&&pe.isProperWebURL(s)&&(e.setAttribute("mcafee_aps","true"),e.addEventListener("click",(()=>{const e=fe.getDomain(s);t.push(e),Be.sessionStore(ye,{[Ge.name]:t})})))}))},n=new MutationObserver((()=>{s()}));s(),n.observe(document,{childList:!0,subtree:!0})}}).main()})();
//# sourceMappingURL=../sourceMap/scripts/content_aps_observer.js.map